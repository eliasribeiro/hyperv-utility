<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="HyperVUtilities.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:HyperVUtilities"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="HyperV Utilities">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid Margin="20">
        <TabView>
            <!-- Aba 1: Host → VM -->
            <TabViewItem Header="Host → VM">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="15" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="20" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="20" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="30" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- Texto informativo -->
                    <Border Grid.Row="0"
                            Background="{ThemeResource SystemFillColorAttentionBackgroundBrush}"
                            BorderBrush="{ThemeResource SystemFillColorAttentionBrush}"
                            BorderThickness="1"
                            CornerRadius="6"
                            Padding="15,10">
                        <StackPanel Orientation="Horizontal">
                            <FontIcon Glyph="&#xE946;" 
                                     FontSize="16"
                                     Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                     Margin="0,0,10,0"
                                     VerticalAlignment="Center"/>
                            <TextBlock Text="⚠️ Importante: A máquina virtual deve estar ativa/ligada para que a transferência funcione corretamente."
                                      FontSize="13"
                                      Foreground="{ThemeResource TextFillColorPrimaryBrush}"
                                      TextWrapping="Wrap"
                                      VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <!-- Grupo Máquina Virtual -->
                    <Border Grid.Row="2" 
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20">
                        <StackPanel>
                            <TextBlock Text="Máquina Virtual" 
                                      FontSize="16" 
                                      FontWeight="SemiBold" 
                                      Margin="0,0,0,15"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="20" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Nome da VM:" 
                                              Margin="0,0,0,5"/>
                                    <TextBox x:Name="VmNameTextBox" 
                                            PlaceholderText="Ex: MinhaVM" />
                                </StackPanel>
                                
                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="Caminho de destino na VM:" 
                                              Margin="0,0,0,5"/>
                                    <TextBox x:Name="VmDestinationPathTextBox" 
                                            PlaceholderText="Ex: C:\Temp\" />
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Grupo Host -->
                    <Border Grid.Row="4" 
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20">
                        <StackPanel>
                            <TextBlock Text="Host" 
                                      FontSize="16" 
                                      FontWeight="SemiBold" 
                                      Margin="0,0,0,15"/>
                            
                            <StackPanel>
                                <TextBlock Text="Arquivo/Pasta local:" 
                                          Margin="0,0,0,5"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="10" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="10" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBox x:Name="LocalPathTextBox" 
                                            Grid.Column="0"
                                            PlaceholderText="Selecione o arquivo ou pasta a ser copiado"
                                            IsReadOnly="True" />
                                    
                                    <Button x:Name="BrowseFileButton" 
                                           Grid.Column="2"
                                           Content="Arquivo"
                                           Click="BrowseFileButton_Click"
                                           MinWidth="80" />
                                    
                                    <Button x:Name="BrowseFolderButton" 
                                           Grid.Column="4"
                                           Content="Pasta"
                                           Click="BrowseFolderButton_Click"
                                           MinWidth="80" />
                                </Grid>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Botão Transferir -->
                    <Button x:Name="TransferButton" 
                           Grid.Row="6"
                           Click="TransferButton_Click"
                           Style="{ThemeResource AccentButtonStyle}"
                           HorizontalAlignment="Center"
                           MinWidth="150"
                           FontSize="14">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <ProgressRing x:Name="LoadingProgressRing"
                                         Width="16" 
                                         Height="16"
                                         Visibility="Collapsed"
                                         IsActive="False"/>
                            <TextBlock x:Name="TransferButtonText" 
                                      Text="Transferir" 
                                      VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <!-- Área de status/log -->
                    <Border Grid.Row="8"
                            Background="{ThemeResource LayerFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="10">
                        <ScrollViewer>
                            <TextBlock x:Name="StatusTextBlock" 
                                      Text="Pronto para transferir arquivos..."
                                      TextWrapping="Wrap"
                                      FontFamily="Consolas"
                                      FontSize="12" />
                        </ScrollViewer>
                    </Border>
                </Grid>
            </TabViewItem>

            <!-- Aba 2: VM → Host -->
            <TabViewItem Header="VM → Host">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="15" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="20" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="20" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="30" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- Texto informativo -->
                    <Border Grid.Row="0"
                            Background="{ThemeResource SystemFillColorAttentionBackgroundBrush}"
                            BorderBrush="{ThemeResource SystemFillColorAttentionBrush}"
                            BorderThickness="1"
                            CornerRadius="6"
                            Padding="15,10">
                        <StackPanel Orientation="Horizontal">
                            <FontIcon Glyph="&#xE946;" 
                                     FontSize="16"
                                     Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                     Margin="0,0,10,0"
                                     VerticalAlignment="Center"/>
                            <TextBlock Text="⚠️ Importante: A máquina virtual deve estar ativa/ligada para que a transferência funcione corretamente."
                                      FontSize="13"
                                      Foreground="{ThemeResource TextFillColorPrimaryBrush}"
                                      TextWrapping="Wrap"
                                      VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <!-- Grupo Máquina Virtual (Origem) -->
                    <Border Grid.Row="2" 
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20">
                        <StackPanel>
                            <TextBlock Text="Máquina Virtual (Origem)" 
                                      FontSize="16" 
                                      FontWeight="SemiBold" 
                                      Margin="0,0,0,15"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="20" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Nome da VM:" 
                                              Margin="0,0,0,5"/>
                                    <TextBox x:Name="VmNameTextBox2" 
                                            PlaceholderText="Ex: MinhaVM" />
                                </StackPanel>
                                
                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="Caminho do arquivo/pasta na VM:" 
                                              Margin="0,0,0,5"/>
                                    <TextBox x:Name="VmSourcePathTextBox" 
                                            PlaceholderText="Ex: C:\Temp\arquivo.txt" />
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Grupo Host (Destino) -->
                    <Border Grid.Row="4" 
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="20">
                        <StackPanel>
                            <TextBlock Text="Host (Destino)" 
                                      FontSize="16" 
                                      FontWeight="SemiBold" 
                                      Margin="0,0,0,15"/>
                            
                            <StackPanel>
                                <TextBlock Text="Pasta de destino local:" 
                                          Margin="0,0,0,5"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="10" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBox x:Name="LocalDestinationPathTextBox" 
                                            Grid.Column="0"
                                            PlaceholderText="Selecione a pasta de destino local"
                                            IsReadOnly="True" />
                                    
                                    <Button x:Name="BrowseDestinationButton" 
                                           Grid.Column="2"
                                           Content="Procurar"
                                           Click="BrowseDestinationButton_Click"
                                           MinWidth="100" />
                                </Grid>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Botão Transferir (Reverso) -->
                    <Button x:Name="TransferReverseButton" 
                           Grid.Row="6"
                           Click="TransferReverseButton_Click"
                           Style="{ThemeResource AccentButtonStyle}"
                           HorizontalAlignment="Center"
                           MinWidth="150"
                           FontSize="14">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <ProgressRing x:Name="LoadingProgressRing2"
                                         Width="16" 
                                         Height="16"
                                         Visibility="Collapsed"
                                         IsActive="False"/>
                            <TextBlock x:Name="TransferReverseButtonText" 
                                      Text="Transferir" 
                                      VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <!-- Área de status/log (Reverso) -->
                    <Border Grid.Row="8"
                            Background="{ThemeResource LayerFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="10">
                        <ScrollViewer>
                            <TextBlock x:Name="StatusTextBlock2" 
                                      Text="Pronto para transferir arquivos da VM para o host..."
                                      TextWrapping="Wrap"
                                      FontFamily="Consolas"
                                      FontSize="12" />
                        </ScrollViewer>
                    </Border>
                </Grid>
            </TabViewItem>
        </TabView>
    </Grid>
</Window>
